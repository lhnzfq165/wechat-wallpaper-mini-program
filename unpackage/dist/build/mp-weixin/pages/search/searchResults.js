(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/searchResults"],{"068d":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return o}));var o={uNavbar:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-navbar/u-navbar")]).then(n.bind(null,"2473"))},uSwiper:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(n.bind(null,"4479"))},uRow:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-row/u-row")]).then(n.bind(null,"7298"))},uCol:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-col/u-col")]).then(n.bind(null,"94ef"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-button/u-button")]).then(n.bind(null,"61e2"))},uModal:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-modal/u-modal")]).then(n.bind(null,"93cf"))},uLoadingPage:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(n.bind(null,"274e"))}},i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.downloadshow=!1})},u=[]},"1b20":function(e,t,n){"use strict";n.r(t);var o=n("068d"),i=n("d9f4");for(var u in i)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(u);n("843d");var s=n("f0c5"),a=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=a.exports},"26b9":function(e,t,n){"use strict";(function(e,o){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=i(n("2eee")),s=i(n("c973")),a=n("cf59"),r=null,l={data:function(){return{ad_id:"",isShowAd:"0",isDownloadStatus:!0,downloadshow:!1,content:"普通下载会消耗1积分。无消耗下载不会消耗积分。",type:"one",title:"提示",isLoading:!0,currTitle:"搜索结果",userinput:"",code:403,image:1,currentPage:0,hasmore:"false",swiperCurrent:0,list3:[""],url_list:[""]}},watch:{code:function(t,n){200==t&&(e.hideLoading(),e.showToast({title:"已保存到相册",icon:"success",duration:3e3}))},image:function(t,n){if(t-1<this.url_list.length&&1!=t){e.showLoading({title:"下载第"+this.image+"/"+this.url_list.length+"张"});var o=this.url_list[t-1];this.download(o,1)}else e.hideLoading(),this.image=1,e.showToast({title:"已全部保存",icon:"success",duration:3e3})}},methods:{downloadPicDeleteUserCount:function(t,n){var o=this;return(0,s.default)(u.default.mark((function i(){var s;return u.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,a._getRequest({url:"/downloadPicDeleteUserCount?num="+t+"&openid="+n,method:"GET"});case 2:s=i.sent,200===s.data["code"]?(o.downloadshow=!1,e.setStorageSync("userinfo",s.data["data"]["userinfo"]),"one"===o.type?o.dow():o.dows()):e.showToast({icon:"error",title:"网络错误"});case 4:case"end":return i.stop()}}),i)})))()},clickButtonType:function(t){var n=this;this.type=t,e.getStorage({key:"setting",success:function(e){"1"===e.data.seStatus?(n.content="one"==t?"普通下载会消耗1积分。无消耗下载不会消耗积分。":"普通下载会消耗"+n.list3.length+"积分。无消耗下载不会消耗积分。",n.isDownloadStatus=!0):(n.content="one"==t?"下载会消耗1积分。":"下载会消耗"+n.list3.length+"积分。",n.isDownloadStatus=!1)}}),this.downloadshow=!0},downloadType:function(){var t=this;e.getStorage({key:"userinfo",success:function(n){"one"===t.type?n.data.uCount<1?e.showToast({icon:"error",title:"积分不足"}):e.$u.throttle((function(){return t.downloadPicDeleteUserCount(1,n.data.uOpenid)}),1200):n.data.uCount<t.list3.length?e.showToast({icon:"error",title:"积分不足"}):e.$u.throttle((function(){return t.downloadPicDeleteUserCount(t.list3.length,n.data.uOpenid)}),1200)},fail:function(){e.showToast({icon:"error",title:"用户未登录"})}})},getSearchResult:function(t,n){var o=this;return(0,s.default)(u.default.mark((function i(){var s;return u.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,a._getRequest({url:"/getSearchResult?pageNumber="+t+"&input="+n,method:"GET"});case 2:s=i.sent,200===s.data["code"]?(o.list3=s.data["data"]["thumb"],o.url_list=s.data["data"]["url"],o.hasmore=s.data["data"]["hasmore"],console.log(o.hasmore)):e.showToast({icon:"error",title:"服务器出现问题咯！"});case 4:case"end":return i.stop()}}),i)})))()},onchage:function(e){this.swiperCurrent=e.current},viewOnePicture:function(){e.setStorage({key:"url",data:this.url_list[this.swiperCurrent]}),e.navigateTo({url:"/pages/preview/preview",animationType:"pop-in",animationDuration:300})},previous:function(){this.currentPage>=1&&(this.currentPage=this.currentPage-1,this.getSearchResult(this.currentPage,this.userinput),this.swiperCurrent=0),console.log(this.currentPage)},next:function(){this.hasmore&&(this.currentPage=this.currentPage+1,this.getSearchResult(this.currentPage,this.userinput),this.swiperCurrent=0),console.log(this.currentPage)},showAd:function(){r.show().catch((function(){r.load().then((function(){return r.show()})).catch((function(t){console.log(t),e.showToast({icon:"error",title:"广告显示失败"})}))}))},dow:function(){this.code=403,e.showLoading({title:"拼命下载中"});var t=this.url_list[this.swiperCurrent];this.download(t,0)},dows:function(){this.code=403,e.showLoading({title:"下载第"+this.image+"/"+this.url_list.length+"张"});var t=this.url_list[0];this.download(t,1)},download:function(t,n){var o=this;e.downloadFile({url:t,success:function(t){e.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){0==n?o.code=200:o.image=o.image+1},fail:function(t){"saveImageToPhotosAlbum:fail:auth denied"!==t.errMsg&&"saveImageToPhotosAlbum:fail auth deny"!==t.errMsg&&"saveImageToPhotosAlbum:fail authorize no response"!==t.errMsg||e.showModal({title:"提示",content:"需要您授权保存相册",showCancel:!1,success:function(t){e.openSetting({success:function(t){console.log("settingdata",t),t.authSetting["scope.writePhotosAlbum"]?e.showModal({title:"提示",content:"获取权限成功,再次点击图片即可保存",showCancel:!1}):e.showModal({title:"提示",content:"获取权限失败，将无法保存到相册哦~",showCancel:!1})},fail:function(e){console.log("failData",e)},complete:function(e){console.log("finishData",e)}})}})}})}})}},onLoad:function(t){var n=this,i=this;0!=Object.keys(t).length&&(i.userinput=t.user_input,t.user_input.length>4?this.currTitle=t.user_input.substring(0,4)+"-搜索结果":this.currTitle=t.user_input+"-搜索结果",i.getSearchResult(i.currentPage,t.user_input).then(setTimeout((function(){i.isLoading=!1}),1200))),e.getStorage({key:"setting",success:function(t){"0"!==t.data.seStatus&&(n.isShowAd="1",n.ad_id=t.data.seVideo,o.createRewardedVideoAd&&(r=o.createRewardedVideoAd({adUnitId:t.data.seIncentive}),r.onLoad((function(){console.log("onLoad event emit")})),r.onError((function(e){console.log("onError event emit",e)})),r.onClose((function(t){t&&t.isEnded?(e.showToast({icon:"error",title:"已获得奖励"}),i.downloadshow=!1,"one"===i.type?i.dow():i.dows()):e.showToast({icon:"error",title:"未获得奖励"})}))))}})}};t.default=l}).call(this,n("543d")["default"],n("bc2e")["default"])},"6cff":function(e,t,n){},"843d":function(e,t,n){"use strict";var o=n("6cff"),i=n.n(o);i.a},"8a8e":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("33bf");o(n("66fd"));var i=o(n("1b20"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},d9f4:function(e,t,n){"use strict";n.r(t);var o=n("26b9"),i=n.n(o);for(var u in o)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(u);t["default"]=i.a}},[["8a8e","common/runtime","common/vendor"]]]);