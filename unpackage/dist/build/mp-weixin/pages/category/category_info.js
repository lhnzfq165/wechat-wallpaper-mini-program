(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/category_info"],{"0f3e":function(t,e,n){"use strict";n.r(e);var o=n("42a2"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},"2d83":function(t,e,n){"use strict";var o=n("f01a"),i=n.n(o);i.a},"42a2":function(t,e,n){"use strict";(function(t,o){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("2eee")),s=i(n("c973")),r=n("cf59"),u=null,c={data:function(){return{ad_id:"",isShowAd:"0",isDownloadStatus:!0,downloadshow:!1,content:"普通下载会消耗1积分。无消耗下载不会消耗积分。",type:"one",title:"提示",isLoading:!0,currentPage:0,totalPage:1,code:403,swiperCurrent:0,image:1,list3:[""],url_list:[""],currTitle:"大分类",currLittleIndex:"0",categoryId:0,childCategoryId:0,list1:[{name:""},{name:""}]}},watch:{code:function(e,n){200==e&&(t.hideLoading(),t.showToast({title:"已保存到相册",icon:"success",duration:3e3}))},image:function(e,n){if(e-1<this.url_list.length&&1!=e){t.showLoading({title:"下载第"+this.image+"/"+this.url_list.length+"张"});var o=this.url_list[e-1];this.download(o,1)}else t.hideLoading(),this.image=1,t.showToast({title:"已全部保存",icon:"success",duration:3e3})}},methods:{downloadPicDeleteUserCount:function(e,n){var o=this;return(0,s.default)(a.default.mark((function i(){var s;return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,r._getRequest({url:"/downloadPicDeleteUserCount?num="+e+"&openid="+n,method:"GET"});case 2:s=i.sent,200===s.data["code"]?(o.downloadshow=!1,t.setStorageSync("userinfo",s.data["data"]["userinfo"]),"one"===o.type?o.dow():o.dows()):t.showToast({icon:"error",title:"网络错误"});case 4:case"end":return i.stop()}}),i)})))()},clickButtonType:function(e){var n=this;this.type=e,t.getStorage({key:"setting",success:function(t){"1"===t.data.seStatus?(n.content="one"==e?"普通下载会消耗1积分。无消耗下载不会消耗积分。":"普通下载会消耗"+n.list3.length+"积分。无消耗下载不会消耗积分。",n.isDownloadStatus=!0):(n.content="one"==e?"下载会消耗1积分。":"下载会消耗"+n.list3.length+"积分。",n.isDownloadStatus=!1)}}),this.downloadshow=!0},clickTabs:function(t){this.categoryId===t["classId"]&&this.childCategoryId===t["id"]||(this.getCategoryImagesByJson(t["classId"],t["id"]),this.categoryId=t["classId"],this.childCategoryId=t["id"],this.swiperCurrent=0)},onchage:function(t){this.swiperCurrent=t.current},downloadType:function(){var e=this;t.getStorage({key:"userinfo",success:function(n){"one"===e.type?n.data.uCount<1?t.showToast({icon:"error",title:"积分不足"}):t.$u.throttle((function(){return e.downloadPicDeleteUserCount(1,n.data.uOpenid)}),1200):n.data.uCount<e.list3.length?t.showToast({icon:"error",title:"积分不足"}):t.$u.throttle((function(){return e.downloadPicDeleteUserCount(e.list3.length,n.data.uOpenid)}),1200)},fail:function(){t.showToast({icon:"error",title:"用户未登录"})}})},viewOnePicture:function(){t.setStorage({key:"url",data:this.url_list[this.swiperCurrent]}),t.navigateTo({url:"/pages/preview/preview",animationType:"pop-in",animationDuration:300})},previous:function(){this.currentPage>=1&&(this.currentPage=this.currentPage-1,this.getCategoryImagesByJson(this.categoryId,this.childCategoryId),this.swiperCurrent=0),console.log(this.currentPage)},next:function(){this.currentPage<this.totalPage&&(this.currentPage=this.currentPage+1,this.getCategoryImagesByJson(this.categoryId,this.childCategoryId),this.swiperCurrent=0),console.log(this.currentPage)},getChildCategory:function(e){var n=this;return(0,s.default)(a.default.mark((function o(){var i;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,r._getRequest({url:"/getChildCategoryList?categoryId="+e,method:"GET"});case 2:i=o.sent,200===i.data["code"]?n.list1=i.data["data"]["childCategory"]:t.showToast({icon:"error",title:"服务器出现问题咯！"});case 4:case"end":return o.stop()}}),o)})))()},getCategoryImagesByJson:function(e,n){var o=this;return(0,s.default)(a.default.mark((function i(){var s;return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,r._getRequest({url:"/getCategoryImages?pageNumber=".concat(o.currentPage,"&categoryId=").concat(e,"&childCategoryId=").concat(n),method:"GET"});case 2:s=i.sent,200===s.data["code"]?(o.list3=s.data["data"]["thumb"],o.url_list=s.data["data"]["url"]):t.showToast({icon:"error",title:"服务器出现问题咯！"});case 4:case"end":return i.stop()}}),i)})))()},showAd:function(){u.show().catch((function(){u.load().then((function(){return u.show()})).catch((function(e){console.log(e),t.showToast({icon:"error",title:"广告显示失败"})}))}))},dow:function(){this.code=403,t.showLoading({title:"拼命下载中"});var e=this.url_list[this.swiperCurrent];this.download(e,0)},dows:function(){this.code=403,t.showLoading({title:"下载第"+this.image+"/"+this.url_list.length+"张"});var e=this.url_list[0];this.download(e,1)},download:function(e,n){var o=this;t.downloadFile({url:e,success:function(e){t.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(){0==n?o.code=200:o.image=o.image+1},fail:function(e){"saveImageToPhotosAlbum:fail:auth denied"!==e.errMsg&&"saveImageToPhotosAlbum:fail auth deny"!==e.errMsg&&"saveImageToPhotosAlbum:fail authorize no response"!==e.errMsg||t.showModal({title:"提示",content:"需要您授权保存相册",showCancel:!1,success:function(e){t.openSetting({success:function(e){console.log("settingdata",e),e.authSetting["scope.writePhotosAlbum"]?t.showModal({title:"提示",content:"获取权限成功,再次点击图片即可保存",showCancel:!1}):t.showModal({title:"提示",content:"获取权限失败，将无法保存到相册哦~",showCancel:!1})},fail:function(t){console.log("failData",t)},complete:function(t){console.log("finishData",t)}})}})}})}})}},onLoad:function(e){var n=this,i=this;if(0!=Object.keys(e).length){i.currTitle=e.title;var a=e.index;i.getChildCategory(e.classId).then((function(){console.log(Math.floor(i.list1[a].picCount/6)),i.totalPage=Math.floor(i.list1[a].picCount/6),i.currLittleIndex=a,i.categoryId=i.list1[i.currLittleIndex].classId,i.childCategoryId=i.list1[i.currLittleIndex].id,i.getCategoryImagesByJson(i.list1[i.currLittleIndex].classId,i.list1[i.currLittleIndex].id).then(setTimeout((function(){i.isLoading=!1}),1200))}))}t.getStorage({key:"setting",success:function(e){"0"!==e.data.seStatus&&(n.isShowAd="1",n.ad_id=e.data.seVideo,o.createRewardedVideoAd&&(u=o.createRewardedVideoAd({adUnitId:e.data.seIncentive}),u.onLoad((function(){console.log("onLoad event emit")})),u.onError((function(t){console.log("onError event emit",t)})),u.onClose((function(e){e&&e.isEnded?(t.showToast({icon:"error",title:"已获得奖励"}),i.downloadshow=!1,"one"===i.type?i.dow():i.dows()):t.showToast({icon:"error",title:"未获得奖励"})}))))}})}};e.default=c}).call(this,n("543d")["default"],n("bc2e")["default"])},7600:function(t,e,n){"use strict";(function(t,e){var o=n("4ea4");n("33bf");o(n("66fd"));var i=o(n("e426"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},8703:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}));var o={uNavbar:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-navbar/u-navbar")]).then(n.bind(null,"2473"))},uTabs:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-tabs/u-tabs")]).then(n.bind(null,"131a"))},uSwiper:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(n.bind(null,"4479"))},uRow:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-row/u-row")]).then(n.bind(null,"7298"))},uCol:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-col/u-col")]).then(n.bind(null,"94ef"))},uButton:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-button/u-button")]).then(n.bind(null,"61e2"))},uModal:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-modal/u-modal")]).then(n.bind(null,"93cf"))},uLoadingPage:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uview-ui/components/u-loading-page/u-loading-page")]).then(n.bind(null,"274e"))}},i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.downloadshow=!1})},a=[]},e426:function(t,e,n){"use strict";n.r(e);var o=n("8703"),i=n("0f3e");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("2d83");var s=n("f0c5"),r=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=r.exports},f01a:function(t,e,n){}},[["7600","common/runtime","common/vendor"]]]);